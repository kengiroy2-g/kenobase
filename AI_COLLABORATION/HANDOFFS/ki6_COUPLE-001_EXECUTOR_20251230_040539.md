---
status: COMPLETE
task: COUPLE-001
role: EXECUTOR
phase: EXECUTOR
files_changed: [kenobase/analysis/alternative_coupling.py, scripts/analyze_alternative_methods.py, tests/unit/test_alternative_coupling.py, results/alternative_coupling_synthetic.json]
summary:
  - kNN-based TE/CMI with lagged conditioning, block-permutation nulls, and metadata-rich CouplingResult updates added in kenobase/analysis/alternative_coupling.py.
  - run_all_methods and grouped BH correction retain source/target names and per-method/control q-values across segments.
  - CLI now supports k-history/k-neighbor tuning, vector/prefix column handling, synthetic mode, and writes config-rich JSON outputs.
  - Synthetic TE smoke run (lags=1, n_perm=5, k_neighbors=3) generated results/alternative_coupling_synthetic.json with ecosystem-only hits.
  - Unit tests expanded for directional TE/CMI and CLI smoke; tests/unit/test_alternative_coupling.py passes.
---
# Rule Confirmation
- Rule 1 (SYSTEM_STATUS + ADR/Docs + git status): UNVERIFIED (SYSTEM_STATUS.json missing; ADR_AXIOM_FIRST_FRAMEWORK.md read; git status run)
- Rule 2 (granularity stated): global
- Rule 3 (semantics defined): directed game pairs per lag with TE/CMI stats, permutation p/q, train/test segment, control flag, representation/history metadata
- Rule 4 (target metric): accuracy
- Rule 5 (helper-only boundaries): CONFIRMED
- Rule 6 (reproducibility): python scripts/analyze_alternative_methods.py --method te --lags 1 --n-permutations 5 --k-neighbors 3 --k-history-target 1 --use-synthetic --output results/alternative_coupling_synthetic.json -> results/alternative_coupling_synthetic.json

## Task Setup
- Granularity: global
- Semantics: TE/CMI per directed pair/lag conditioned on target/source history with permutation nulls, BH per method/control, control flag for EuroJackpot
- Target metric: accuracy

## Repro Commands
- python -m pytest tests/unit/test_alternative_coupling.py -> console (25 tests)
- python scripts/analyze_alternative_methods.py --method te --lags 1 --n-permutations 5 --k-neighbors 3 --k-history-target 1 --use-synthetic --output results/alternative_coupling_synthetic.json -> results/alternative_coupling_synthetic.json

# Umsetzung
- kNN CMI estimator, lagged slicing, and block permutations implemented for TE/CMI with metadata propagation and grouped BH correction.
- CLI extended for k-history/k-neighbor tuning, vector representations, and synthetic smoke mode; outputs include config/data summaries.
- Added directional TE/CMI and CLI smoke tests; all unit tests now pass.